import{d as $,y as v,a as P,A as m,r as b,n as y,o as r,g as c,p as F,z,f as e,t as a,h as k,v as I,q as l,k as h,i as C,F as p,m as f,s as g,x as w}from"./index-2321088d.js";const S="/user",x=$({id:"profile",state:()=>({peers:[],user:{},filter:"",pageSize:10,pageOffset:0,pages:[],fetching:!1}),getters:{FindPeers:t=>s=>t.peers.find(d=>d.Identifier===s),CountPeers:t=>t.peers.length,FilteredPeerCount:t=>t.FilteredPeers.length,Peers:t=>t.peers,FilteredPeers:t=>t.filter?t.peers.filter(s=>s.DisplayName.includes(t.filter)||s.Identifier.includes(t.filter)):t.peers,FilteredAndPagedPeers:t=>t.FilteredPeers.slice(t.pageOffset,t.pageOffset+t.pageSize),isFetching:t=>t.fetching,hasNextPage:t=>t.pageOffset<t.FilteredPeerCount-t.pageSize,hasPrevPage:t=>t.pageOffset>0,currentPage:t=>t.pageOffset/t.pageSize+1},actions:{afterPageSizeChange(){this.pageOffset=0,this.calculatePages()},calculatePages(){let t=1;this.pages=[];for(let s=0;s<this.FilteredPeerCount;s+=this.pageSize)this.pages.push(t++)},gotoPage(t){this.pageOffset=(t-1)*this.pageSize,this.calculatePages()},nextPage(){this.pageOffset+=this.pageSize,this.calculatePages()},previousPage(){this.pageOffset-=this.pageSize,this.calculatePages()},setPeers(t){this.peers=t,this.fetching=!1},setUser(t){this.user=t,this.fetching=!1},async LoadPeers(){this.fetching=!0;let t=v().user.Identifier;return P.get(`${S}/${t}/peers`).then(this.setPeers).catch(s=>{this.setPeers([]),console.log("Failed to load user peers for ",t,": ",s),m({title:"Backend Connection Failure",text:"Failed to load user peers!"})})},async LoadUser(){this.fetching=!0;let t=v().user.Identifier;return P.get(`${S}/${t}`).then(this.setUser).catch(s=>{this.setUser({}),console.log("Failed to load user for ",t,": ",s),m({title:"Backend Connection Failure",text:"Failed to load user!"})})}}}),O={class:"mt-4 row"},U={class:"col-12 col-lg-5"},N={class:"mt-2"},D={class:"col-12 col-lg-4 text-lg-end"},L={class:"form-group d-inline"},V={class:"input-group mb-3"},A=e("button",{class:"input-group-text btn btn-primary",title:"Search"},[e("i",{class:"fa-solid fa-search"})],-1),B={class:"col-12 col-lg-3 text-lg-end"},H=e("i",{class:"fa fa-plus me-1"},null,-1),M=e("i",{class:"fa fa-user"},null,-1),E=[H,M],T={class:"mt-2 table-responsive"},W={key:0},q={key:1,id:"peerTable",class:"table table-sm"},K=e("th",{scope:"col"},[e("input",{id:"flexCheckDefault",class:"form-check-input",title:"Select all",type:"checkbox",value:""})],-1),j={scope:"col"},G={scope:"col"},J={scope:"col"},Q={scope:"col"},R={scope:"col"},X=e("th",{scope:"col"},null,-1),Y=e("th",{scope:"row"},[e("input",{id:"flexCheckDefault",class:"form-check-input",type:"checkbox",value:""})],-1),Z={class:"text-center"},ee=["onClick"],te=e("i",{class:"fas fa-eye me-2"},null,-1),se=[te],ie=["onClick"],le=e("i",{class:"fas fa-cog"},null,-1),oe=[le],ae=e("hr",null,null,-1),ne={class:"mt-3"},re={class:"row"},ce={class:"col-6"},de={class:"pagination pagination-sm"},ue=["onClick"],pe={class:"col-6"},he={class:"form-group row"},fe={class:"col-sm-6 col-form-label text-end",for:"paginationSelector"},ge={class:"col-sm-6"},_e=e("option",{value:"10"},"10",-1),ve=e("option",{value:"25"},"25",-1),Pe=e("option",{value:"50"},"50",-1),me=e("option",{value:"100"},"100",-1),be={value:"999999999"},Ce={__name:"ProfileView",setup(t){const s=x(),d=b(""),_=b("");return y(async()=>{await s.LoadUser(),await s.LoadPeers()}),(n,o)=>(r(),c(p,null,[F(z,{peerId:d.value,visible:d.value!=="",onClose:o[0]||(o[0]=i=>d.value="")},null,8,["peerId","visible"]),e("div",O,[e("div",U,[e("h2",N,a(n.$t("profile.h2-clients")),1)]),e("div",D,[e("div",L,[e("div",V,[k(e("input",{"onUpdate:modelValue":o[1]||(o[1]=i=>l(s).filter=i),class:"form-control",placeholder:"Search...",type:"text",onKeyup:o[2]||(o[2]=(...i)=>l(s).afterPageSizeChange&&l(s).afterPageSizeChange(...i))},null,544),[[I,l(s).filter]]),A])])]),e("div",B,[e("a",{class:"btn btn-primary ms-2",href:"#",title:"Add a peer",onClick:o[3]||(o[3]=h(i=>_.value="#NEW#",["prevent"]))},E)])]),e("div",T,[l(s).CountPeers===0?(r(),c("div",W,[e("h4",null,a(n.$t("profile.noPeerSelect.h4")),1),e("p",null,a(n.$t("profile.noPeerSelect.message")),1)])):C("",!0),l(s).CountPeers!==0?(r(),c("table",q,[e("thead",null,[e("tr",null,[K,e("th",j,a(n.$t("profile.tableHeadings[0]")),1),e("th",G,a(n.$t("profile.tableHeadings[1]")),1),e("th",J,a(n.$t("profile.tableHeadings[2]")),1),e("th",Q,a(n.$t("profile.tableHeadings[3]")),1),e("th",R,a(n.$t("profile.tableHeadings[4]")),1),X])]),e("tbody",null,[(r(!0),c(p,null,f(l(s).FilteredAndPagedPeers,i=>(r(),c("tr",{key:i.Identifier},[Y,e("td",null,a(i.DisplayName),1),e("td",null,a(i.Identifier),1),e("td",null,a(i.UserIdentifier),1),e("td",null,[(r(!0),c(p,null,f(i.Addresses,u=>(r(),c("span",{key:u,class:"badge rounded-pill bg-light"},a(u),1))),128))]),e("td",null,a(i.LastConnected),1),e("td",Z,[e("a",{href:"#",title:"Show peer",onClick:h(u=>d.value=i.Identifier,["prevent"])},se,8,ee),e("a",{href:"#",title:"Edit peer",onClick:h(u=>_.value=i.Identifier,["prevent"])},oe,8,ie)])]))),128))])])):C("",!0)]),ae,e("div",ne,[e("div",re,[e("div",ce,[e("ul",de,[e("li",{class:g([{disabled:l(s).pageOffset===0},"page-item"])},[e("a",{class:"page-link",onClick:o[4]||(o[4]=(...i)=>l(s).previousPage&&l(s).previousPage(...i))},"«")],2),(r(!0),c(p,null,f(l(s).pages,i=>(r(),c("li",{key:i,class:g([{active:l(s).currentPage===i},"page-item"])},[e("a",{class:"page-link",onClick:u=>l(s).gotoPage(i)},a(i),9,ue)],2))),128)),e("li",{class:g([{disabled:!l(s).hasNextPage},"page-item"])},[e("a",{class:"page-link",onClick:o[5]||(o[5]=(...i)=>l(s).nextPage&&l(s).nextPage(...i))},"»")],2)])]),e("div",pe,[e("div",he,[e("label",fe,a(n.$t("profile.pagination.size"))+":",1),e("div",ge,[k(e("select",{"onUpdate:modelValue":o[6]||(o[6]=i=>l(s).pageSize=i),class:"form-select",onClick:o[7]||(o[7]=i=>l(s).afterPageSizeChange())},[_e,ve,Pe,me,e("option",be,a(n.$t("profile.pagination.all")),1)],512),[[w,l(s).pageSize,void 0,{number:!0}]])])])])])])],64))}};export{Ce as default};
